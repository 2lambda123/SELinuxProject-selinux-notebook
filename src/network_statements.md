# Network Labeling Statements

- [Network Address Formats](#network-address-formats)
  - [IPv4 Address Format](#ipv4-address-format)
  - [IPv6 Address Formats](#ipv6-address-formats)
- [*netifcon*](#netifcon)
- [*nodecon*](#nodecon)
- [*portcon*](#portcon)


The network labeling statements are used to label the following objects:

**Network interfaces** - This covers those interfaces managed by the
***ifconfig**(8)* command.

**Network nodes** - These are generally used to specify host systems
using either IPv4 or IPv6 addresses.

**Network ports** - These can be either udp, tcp, dccp or sctp port numbers.

A security context is defined by these network labeling statements,
therefore if the policy supports MCS / MLS, then an *mls_range* is
required as described in the
[**MLS Statements - MLS range Definition**](mls_statements.md#mls-range-definition)
section. Note that there are no terminating semi-colons ';' on these statements.

If any of the network objects do not have a specific security context
assigned by the policy, then the value given in the policies initial SID
is used (*netif*, *node* or *port* respectively), as shown below:

```
# Network Initial SIDs from the MLS Reference Policy:

sid netif system_u:object_r:netif_t:s0 - s15:c0.c255
sid node system_u:object_r:node_t:s0 - s15:c0.c255
sid port system_u:object_r:port_t:s0
```

## Network Address Formats

### IPv4 Address Format

IPv4 addresses are represented in dotted-decimal notation (four
numbers, each ranging from 0 to 255, separated by dots as shown:

```
192.77.188.166
```

### IPv6 Address Formats

IPv6 addresses are written as eight groups of four hexadecimal digits,
where each group is separated by a colon ':' as follows:

```
2001:0db8:85a3:0000:0000:8a2e:0370:7334
```

To shorten the writing and presentation of addresses, the following
rules apply:

Any leading zeros in a group may be replaced with a single '0' as shown:

```
2001:db8:85a3:0:0:8a2e:370:7334
```

Any leading zeros in a group may be omitted and be replaced with two
colons '::', however this is only allowed once in an address as follows:

```
2001:db8:85a3::8a2e:370:7334
```

The *localhost* (loopback) address can be written as:

```
0000:0000:0000:0000:0000:0000:0000:0001

Or

::1
```

An undetermined IPv6 address i.e. all bits are zero is written as:

```
::
```

## *netifcon*

The *netifcon* statement is used to label network interface objects (e.g.
eth0) for peer labeling (see the
[***netif* object class**](object_classes_permissions.md#network-object-classes)).

It is also possible to use the ***semanage**(8)* *interface* command to
associate the interface to a security context.

**The statement definition is:**

```
netifcon netif_id netif_context packet_context
```

**Where:**

*netifcon*

The *netifcon* keyword.

*netif_id*

The network interface name (e.g. eth0).

*netif_context*

The security context allocated to the network interface.

*packet_context*

The security context allocated packets. Note that these are defined but unused.
The ***iptables**(8)* / ***nft**(8)*
[**SECMARK services**](network_support.md#packet-controls-secmark) should be
used to label packets.

**The statement is valid in:**

Policy Type

| Monolithic Policy       | Base Policy             | Module Policy           |
| ----------------------- | ----------------------- | ----------------------- |
| Yes                     | Yes                     | No                      |

Conditional Policy Statements

| *if* Statement          | *optional* Statement    | *require* Statement     |
| ----------------------- | ----------------------- | ----------------------- |
| No                      | No                      | No                      |

**Example:**

```
# The following netifcon statement has been taken from the
# MLS policy that shows an interface name of lo with the same
# security context assigned to both the interface and packets.

netifcon lo system_u:object_r:lo_netif_t:s0 - s15:c0.c255 system_u:object_r:unlabeled_t:s0 - s15:c0.c255
```

***semanage**(8)* **Command example:**

```
semanage interface -a -t netif_t eth2
```

This command will produce the following file in the default
\<SELINUXTYPE\> policy store and then activate the policy:

*/var/lib/selinux/\<SELINUXTYPE\>/active/interfaces.local*:

```
# This file is auto-generated by libsemanage
# Do not edit directly.

netifcon eth2 system_u:object_r:netif_t:s0
system_u:object_r:netif_t:s0
```

## *nodecon*

The *nodecon* statement is used to label network address objects for peer
labeling (see the
[***node* object class**](object_classes_permissions.md#network-object-classes)
that represent IPv4 or IPv6 IP addresses and network masks.

It is also possible to add these outside of the policy using the
***semanage**(8)* *node* command that will associate the node to a security
context.

Since ***checkpolicy**(8)* 3.7 the subnet and netmask can be specified together
by using the Classless Inter-Domain Routing (CIDR) notation.

**The statement definition is:**

```
nodecon subnet netmask node_context
nodecon cidr_address node_context
```

**Where:**

*nodecon*

The *nodecon* keyword.

*subnet*

The subnet or specific IP address in IPv4 or IPv6 format.
Note that the subnet and netmask values are used to ensure that the
*node_context* is assigned to all IP addresses within the subnet range.

*netmask*

The subnet mask in IPv4 or IPv6 format.

*cidr_address*

The IP address in CIDR notation, consisting of a IPv4 or IPv6 address, and the
netmask as a number of leading bits, joined by a slash ('/').

*node_context*

The security context for the node.

**The statement is valid in:**

Policy Type

| Monolithic Policy       | Base Policy             | Module Policy           |
| ----------------------- | ----------------------- | ----------------------- |
| Yes                     | Yes                     | No                      |

Conditional Policy Statements

| *if* Statement          | *optional* Statement    | *require* Statement     |
| ----------------------- | ----------------------- | ----------------------- |
| No                      | No                      | No                      |

**Examples:**

```
# The MLS policy nodecon statement using an IPv4 address:

nodecon 127.0.0.1 255.255.255.255 system_u:object_r:lo_node_t:s0 - s15:c0.c255
nodecon 127.0.0.1/32              system_u:object_r:lo_node_t:s0 - s15:c0.c255
```

```
# The MLS policy nodecon statement for the multicast address
# using an IPv6 address:

nodecon ff00:: ff00:: system_u:object_r:multicast_node_t:s0 - s15:c0.c255
nodecon ff00::/8      system_u:object_r:multicast_node_t:s0 - s15:c0.c255
```

***semanage**(8)* **Command example:**

```
semanage node -a -t node_t -p ipv4 -M 255.255.255.255 127.0.0.2
```

This command will produce the following file in the default
\<SELINUXTYPE\> policy store and then activate the policy:

*/var/lib/selinux/\<SELINUXTYPE\>/active/nodes.local*:

```
# This file is auto-generated by libsemanage
# Do not edit directly.

nodecon ipv4 127.0.0.2 255.255.255.255 system_u:object_r:node_t:s0
```

## *portcon*

The *portcon* statement is used to label udp, tcp, dccp or sctp ports.

It is also possible to add a security context to ports outside the
policy using the ***semanage**(8)* *port* command that will associate the port
(or range of ports) to a security context.

**The statement definition is:**

```
portcon protocol port_number port_context
```

**Where:**

*portcon*

The *portcon* keyword.

*protocol*

The protocol type. Valid entries are udp, tcp or dccp.

*port_number*

The port number or range of ports. The ranges are separated by a hyphen '-'.

*port_context*

The security context for the port or range of ports.

**The statement is valid in:**

Policy Type

| Monolithic Policy       | Base Policy             | Module Policy           |
| ----------------------- | ----------------------- | ----------------------- |
| Yes                     | Yes                     | No                      |

Conditional Policy Statements

| *if* Statement          | *optional* Statement    | *require* Statement     |
| ----------------------- | ----------------------- | ----------------------- |
| No                      | No                      | No                      |

**Examples:**

```
# The MLS policy portcon statements:
portcon tcp 20 system_u:object_r:ftp_data_port_t:s0
portcon tcp 21 system_u:object_r:ftp_port_t:s0
portcon tcp 600-1023 system_u:object_r:hi_reserved_port_t:s0
portcon udp 600-1023 system_u:object_r:hi_reserved_port_t:s0
portcon tcp 1-599 system_u:object_r:reserved_port_t:s0
portcon udp 1-599 system_u:object_r:reserved_port_t:s0
```

***semanage**(8)* **Command example:**

```
semanage port -a -t reserved_port_t -p udp 1234
```

This command will produce the following file in the default
\<SELINUXTYPE\> policy store and then activate the policy:

*/var/lib/selinux/\<SELINUXTYPE\>/active/ports.local*:

```
# This file is auto-generated by libsemanage
# Do not edit directly.

portcon udp 1234 system_u:object_r:reserved_port_t:s0
```

<!-- %CUTHERE% -->

---
**[[ PREV ]](file_labeling_statements.md)** **[[ TOP ]](#)** **[[ NEXT ]](infiniband_statements.md)**
