# User Statements

## `user`

The user statement declares an SELinux user identifier within the policy
and associates it to one or more roles. The statement also allows an
optional MLS level and range to control a users security level. It is
also possible to add SELinux user id's outside the policy using the
'semanage user' command that will associate the user with roles
previously declared within the policy.

**The statement definition is:**

`user seuser_id roles role_id;`

Or for MCS/MLS Policy:

`user seuser_id roles role_id level mls_level range mls_range;`


Where:

<table>
<tbody>
<tr>
<td><code>user</code></td>
<td>The <code>user</code> keyword.</td>
</tr>
<tr>
<td><code>seuser_id</code></td>
<td>The SELinux user identifier.</td>
</tr>
<tr>
<td><code>roles</code></td>
<td>The <code>roles</code> keyword.</td>
</tr>
<tr>
<td><code>role_id</code></td>
<td>One or more previously declared <code>role</code> or <code>attribute_role<code> identifiers. Multiple <code>role</code> identifiers consist of a space separated list enclosed in braces '{}'.</td>
</tr>
<tr>
<td><code>level</code></td>
<td>If MLS is configured, the MLS <code>level</code> keyword.</td>
</tr>
<tr>
<td><code>mls_level</code></td>
<td><p>The users default MLS security level that has been previously declared with a <code>level</code> statement</em></em>.</p>
<p>Note that the compiler only accepts the <code>sensitivity</code> component of the <code>level</code> (e.g. s0).</p></td>
</tr>
<tr>
<td><code>range</code></td>
<td>If MLS is configured, the MLS <code>range</code> keyword.</td>
</tr>
<tr>
<td><code>mls_range</code></td>
<td>The range of security levels that the user can run. The format is described in the <a href="mls_statements.md#mls-range-definition">"MLS <code>range</code> Definition"</a> section.</td>
</tr>
</tbody>
</table>

**The statement is valid in:**

<table style="text-align:center">
<tbody>
<tr style="background-color:#D3D3D3;">
<td><strong>Monolithic Policy</strong></td>
<td><strong>Base Policy</strong></td>
<td><strong>Module Policy</strong></td>
</tr>
<tr>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr style="background-color:#D3D3D3;">
<td><strong>Conditional Policy <code>if</code> Statement</strong></td>
<td><strong><code>optional</code> Statement</strong></td>
<td><strong><code>require</code> Statement</strong></td>
</tr>
<tr>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
</tbody>
</table>

**Examples:**

```
# Using the user statement to define an SELinux user user_u that
# has been assigned the role of user_r. The SELinux user_u is a
# generic user identity for Linux users who have no specific
# SELinux user identity defined.
#

user user_u roles { user_r };
```

**MLS Examples:**

```
# Using the user statement to define an MLS SELinux user user_u
# that has been assigned the role of user_r and has a default
# login security level of s0 assigned, and is only allowed
# access to the s0 range of security levels:

user user_u roles { user_r } level s0 range s0;
```

```
# Using the user statement to define an MLS SELinux user
# sysadm_u that has been assigned the role of sysadm_r and has
# a default login security level of s0 assigned, and is
# allowed access to the range of security levels (low - high)
# between s0 and s15:c0.c255:

user sysadm_u roles { sysadm_r } level s0 range s0-s15:c0.c255;
```

***semanage**(8)* **Command example:**

```
# Add user mque_u to SELinux and associate to the unconfined_r role:

semanage user -a -R unconfined_r mque_u
```

This command will produce the following files in the default
&lt;SELINUXTYPE&gt; policy store and then activate the policy:

*/var/lib/selinux/&lt;SELINUXTYPE&gt;/active/users.local*:

```
# This file is auto-generated by libsemanage
# Do not edit directly.

user mque_u roles { unconfined_r } ;
```

*/var/lib/selinux/&lt;SELINUXTYPE&gt;/active/users_extra*:

```
# This file is auto-generated by libsemanage
# Do not edit directly.

user mque_u prefix user;
```

*/var/lib/selinux/&lt;SELINUXTYPE&gt;/active/users_extra.local*:

```
# This file is auto-generated by libsemanage
# Do not edit directly.

user mque_u prefix user;
```

<br>

<!-- %CUTHERE% -->

<table>
<tbody>
<td><center>
<p><a href="default_rules.md#default-object-rules" title="Default Rules"> <strong>Previous</strong></a></p>
</center></td>
<td><center>
<p><a href="README.md#the-selinux-notebook" title="The SELinux Notebook"> <strong>Home</strong></a></p>
</center></td>
<td><center>
<p><a href="role_statements.md#role-statements" title="Role Statements"> <strong>Next</strong></a></p>
</center></td>
</tbody>
</table>

<head>
    <style>table { border-collapse: collapse; }
    table, td, th { border: 1px solid black; }
    </style>
</head>
